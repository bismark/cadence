{
  "id": "fcc24d29",
  "title": "[P3] Escape chapterId in HTML template",
  "tags": [
    "cleanup",
    "P3",
    "align"
  ],
  "status": "closed",
  "created_at": "2026-02-01T16:49:12.648Z"
}

# HTML attribute interpolated without escaping

**File:** `compiler/src/index.ts:450`

```typescript
<div class="cadence-content" data-chapter-id="${chapterId}">
```

## Problem
`chapterId` could break HTML if it contains quotes or special characters. Low risk since it comes from EPUB metadata, but defensive coding is better.

## Fix
Escape the value before interpolation:
```typescript
const escapeAttr = (s: string) => s.replace(/"/g, '&quot;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
// ...
data-chapter-id="${escapeAttr(chapterId)}"
```
