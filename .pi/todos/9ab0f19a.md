{
  "id": "9ab0f19a",
  "title": "[P3] Make ADB jump-page intents reliable during startup/loading",
  "tags": [
    "player",
    "navigation",
    "adb",
    "p3"
  ],
  "status": "closed",
  "created_at": "2026-02-10T23:51:43.995Z"
}

`MainActivity` emits page-jump requests via `MutableSharedFlow` with default `replay = 0`.

If an intent arrives before `PlayerScreen` starts collecting (e.g., while permissions or bundle load is in progress), the jump is dropped.

## Impact
ADB jump behavior is nondeterministic during app startup.

## Suggested fix
Use a replayed/pending mechanism (e.g., `MutableSharedFlow(replay = 1)` with consumption/reset, or store pending page index in activity/app state and apply once player is ready).

## Acceptance
- A jump intent delivered at launch/startup is applied once the player is ready.
- In-app `singleTop` jumps still work.
- Out-of-range clamping behavior remains unchanged.

## Completed (2026-02-10)
- Updated `MainActivity` jump request flow to retain the latest pending page jump during startup/loading:
  - `MutableSharedFlow<Int>(replay = 1, extraBufferCapacity = 1, onBufferOverflow = DROP_OLDEST)`
- This ensures `onNewIntent()` page jumps that arrive before `PlayerScreen` collection are replayed when the player becomes ready.
- Existing jump handling in `PlayerScreen.jumpToPage()` remains unchanged, so out-of-range clamping behavior is preserved.

## Verification
- Ran required player checks:
  - `cd player && ./scripts/verify.sh`
- Result: PASS (`compileDebugKotlin`, `detekt`, `lintDebug`, `buildHealth`).
